pipeline {
    agent any

    stages {
        stage('Build') {
            steps {
                echo 'Executing Build...'
            }
        }
        stage('Testing') {
            steps {
                echo 'Executing Test...'
            }
        }
    }
    post {
        always {
            sh 'echo "POST is called"'
            withCredentials([usernamePassword(credentialsId: 'df5b8f79-06df-4c51-84a0-0bac57b780b8', usernameVariable: 'akhilesh-oc', passwordVariable: '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')]) {
              sh """
              curl -s -H "Authorization: token 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" -X POST -d '{"body": "Testing PR comment"}' https://api.github.com/repos/akhilesh-oc/learn-terraform/${CHANGE_ID}/comments
              """
            }
        }
    }
}